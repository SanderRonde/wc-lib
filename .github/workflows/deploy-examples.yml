name: 'Deploy examples website'

on:
    create:
        tags:
            - '*'



jobs:
    deploy-website:
        if: ${{ github.ref == 'refs/heads/master' }}
        runs-on: ubuntu-latest
        steps:
            - name: Dump GitHub context
              env:
                  GITHUB_CONTEXT: ${{ toJSON(github) }}
              run: echo "$GITHUB_CONTEXT"
            - name: Dump job context
              env:
                  JOB_CONTEXT: ${{ toJSON(job) }}
              run: echo "$JOB_CONTEXT"
            - name: Dump steps context
              env:
                  STEPS_CONTEXT: ${{ toJSON(steps) }}
              run: echo "$STEPS_CONTEXT"
            - name: Dump runner context
              env:
                  RUNNER_CONTEXT: ${{ toJSON(runner) }}
              run: echo "$RUNNER_CONTEXT"
            - name: Dump strategy context
              env:
                  STRATEGY_CONTEXT: ${{ toJSON(strategy) }}
              run: echo "$STRATEGY_CONTEXT"
            - name: Dump matrix context
              env:
                  MATRIX_CONTEXT: ${{ toJSON(matrix) }}
              run: echo "$MATRIX_CONTEXT"

            - name: Checkout
              uses: actions/checkout@v2.3.1

            - name: Node
              uses: actions/setup-node@v2
              with:
                  node-version: 16

            - name: Install
              run: |
                  yarn --ignore-engines

            - name: Build
              run: |
                  yarn makfy prepack
                  yarn makfy compile --dir examples
                  yarn makfy website

            - name: Deploy
              uses: JamesIves/github-pages-deploy-action@4.1.2
              with:
                  branch: gh-pages
                  folder: examples
                  dry-run: true
